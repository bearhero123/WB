# å¾®åšè¶…è¯è‡ªåŠ¨ç­¾åˆ°ç³»ç»Ÿ

åŸºäº FastAPI + Vue 3 + PostgreSQL çš„å¾®åšè¶…è¯è‡ªåŠ¨ç­¾åˆ°ç³»ç»Ÿï¼Œæ”¯æŒå¤šè´¦å·ç®¡ç†ã€å®šæ—¶ç­¾åˆ°ã€æ¨é€é€šçŸ¥ã€‚

## åŠŸèƒ½ç‰¹æ€§

- ğŸ” **å¤šè´¦å·ç®¡ç†** â€” æ”¯æŒå¤šå¾®åšè´¦å· Cookie ç®¡ç†
- â° **å®šæ—¶ç­¾åˆ°** â€” æ¯æ—¥è‡ªåŠ¨ç­¾åˆ°æ‰€æœ‰å·²å…³æ³¨è¶…è¯
- ğŸ“± **GUI å®¢æˆ·ç«¯** â€” Windows/macOS æ¡Œé¢ç«¯ Cookie æå–å·¥å…·
- ğŸ”” **æ¨é€é€šçŸ¥** â€” Serveré…±å®æ—¶æ¨é€ç­¾åˆ°ç»“æœ
- ğŸ”‘ **å¯†é’¥ç®¡ç†** â€” å®‰å…¨çš„ API Key é‰´æƒæœºåˆ¶
- ğŸ–¥ï¸ **ç®¡ç†åå°** â€” Web ç«¯å¯è§†åŒ–ç®¡ç†ç•Œé¢
- ğŸ³ **Docker éƒ¨ç½²** â€” ä¸€é”® docker compose éƒ¨ç½²

## å¿«é€Ÿéƒ¨ç½²

### 1. ç¯å¢ƒè¦æ±‚

- Docker + Docker Compose

### 2. é…ç½®

```bash
# å¤åˆ¶ç¯å¢ƒå˜é‡æ¨¡æ¿
cp .env.example .env

# ç¼–è¾‘é…ç½®ï¼ˆå¿…é¡»ä¿®æ”¹ ADMIN_API_KEYï¼‰
vim .env
```

### 3. å¯åŠ¨

```bash
docker compose up -d --build
```

### 4. è®¿é—®

| æœåŠ¡ | åœ°å€ |
|------|------|
| ç®¡ç†åå° | http://your-server:1235 |
| åç«¯ API | http://your-server:1234 |

## é¡¹ç›®ç»“æ„

```
â”œâ”€â”€ docker-compose.yml      # Docker ç¼–æ’æ–‡ä»¶
â”œâ”€â”€ .env                    # ç¯å¢ƒå˜é‡
â”œâ”€â”€ backend/                # FastAPI åç«¯
â”‚   â”œâ”€â”€ app/
â”‚   â”‚   â”œâ”€â”€ api/            # API è·¯ç”±
â”‚   â”‚   â”œâ”€â”€ models/         # ORM æ¨¡å‹
â”‚   â”‚   â”œâ”€â”€ schemas/        # Pydantic Schema
â”‚   â”‚   â”œâ”€â”€ services/       # ä¸šåŠ¡é€»è¾‘
â”‚   â”‚   â”œâ”€â”€ middleware/     # è®¤è¯ä¸­é—´ä»¶
â”‚   â”‚   â””â”€â”€ main.py         # åº”ç”¨å…¥å£
â”‚   â”œâ”€â”€ alembic/            # æ•°æ®åº“è¿ç§»
â”‚   â””â”€â”€ Dockerfile
â”œâ”€â”€ frontend/               # Vue 3 å‰ç«¯
â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”œâ”€â”€ views/          # é¡µé¢ç»„ä»¶
â”‚   â”‚   â”œâ”€â”€ layouts/        # å¸ƒå±€ç»„ä»¶
â”‚   â”‚   â”œâ”€â”€ api/            # API å°è£…
â”‚   â”‚   â””â”€â”€ router/         # è·¯ç”±é…ç½®
â”‚   â”œâ”€â”€ Dockerfile
â”‚   â””â”€â”€ nginx.conf
â””â”€â”€ weibo_cookie_gui.py     # GUI å®¢æˆ·ç«¯
```

## ä½¿ç”¨æµç¨‹

1. **éƒ¨ç½²ç³»ç»Ÿ** â€” docker-compose å¯åŠ¨
2. **ç™»å½•ç®¡ç†åå°** â€” ä½¿ç”¨ ADMIN_API_KEY ç™»å½•
3. **åˆ›å»ºå¯†é’¥** â€” åœ¨å¯†é’¥ç®¡ç†é¡µé¢ç”Ÿæˆ API Key
4. **æå– Cookie** â€” è¿è¡Œ `weibo_cookie_gui.py`ï¼Œæ‰«ç ç™»å½•åä¸Šä¼ 
5. **é…ç½®å®šæ—¶** â€” åœ¨è´¦å·ç®¡ç†é¡µé¢è®¾ç½®ç­¾åˆ°æ—¶é—´
6. **é…ç½®æ¨é€** â€” è®¾ç½® Serveré…± SendKeyï¼ˆå¯é€‰ï¼‰

## API æ¥å£

### å¤–éƒ¨æ¥å£ï¼ˆGUI å®¢æˆ·ç«¯ä½¿ç”¨ï¼‰

| æ–¹æ³• | è·¯å¾„ | è¯´æ˜ |
|------|------|------|
| POST | `/api/external/key/verify` | éªŒè¯å¯†é’¥ |
| POST | `/api/external/cookie/update` | æ›´æ–° Cookie |

### ç®¡ç†æ¥å£

| æ–¹æ³• | è·¯å¾„ | è¯´æ˜ |
|------|------|------|
| GET/POST | `/api/admin/accounts` | è´¦å·åˆ—è¡¨/åˆ›å»º |
| PUT/DELETE | `/api/admin/accounts/{id}` | æ›´æ–°/åˆ é™¤ |
| GET/POST | `/api/admin/keys` | å¯†é’¥åˆ—è¡¨/ç”Ÿæˆ |
| POST | `/api/admin/tasks/checkin/{id}` | æ‰‹åŠ¨ç­¾åˆ° |
| POST | `/api/admin/tasks/checkin-all` | å…¨éƒ¨ç­¾åˆ° |
| GET | `/api/admin/tasks/logs` | ä»»åŠ¡æ—¥å¿— |
| POST | `/api/admin/push/test` | æµ‹è¯•æ¨é€ |

## æŠ€æœ¯æ ˆ

- **åç«¯**: Python 3.13 / FastAPI / SQLAlchemy 2.0 / APScheduler
- **å‰ç«¯**: Vue 3 / Vite / TypeScript / Element Plus
- **æ•°æ®åº“**: PostgreSQL 15
- **éƒ¨ç½²**: Docker / Nginx
